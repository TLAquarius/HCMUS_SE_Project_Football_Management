{% extends "base.html" %}

{% block title %}Cập Nhật Kết Quả Trận Đấu{% endblock %}

{% block sidebar %}
    {{ super() }} <!-- Include existing sidebar content from base.html -->
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">Cập Nhật Kết Quả Trận Đấu</h2>

    <!-- Search Bar -->
    <div class="form-group">
        <input type="text" class="form-control" id="searchInput" placeholder="Tìm kiếm trận đấu">
    </div>

    <!-- Matches Table -->
    <table class="table table-striped" id="matchesTable">
        <thead>
            <tr>
                <th>Đội Nhà</th>
                <th>Đội Khách</th>
                <th>Ngày-Giờ</th>
                <th>Sân</th>
                <th>Chọn</th>
            </tr>
        </thead>
        <tbody>
            {% for match in matches %}
            <tr>
                <td>{{ match.host_team.name }}</td>
                <td>{{ match.guest_team.name }}</td>
                <td>{{ match.match_datetime }}</td>
                <td>{{ match.stadium }}</td>
                <td><button type="button" class="btn btn-primary" onclick="selectMatch({{ match.id }}, '{{ match.host_team.name }}', '{{ match.guest_team.name }}')">Chọn</button></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Score Form -->
    <div id="scoreForm" class="mt-4" style="display: none;">
        <h4>Nhập Kết Quả</h4>
        <form id="resultForm" method="post" action="{{ url_for('update_result', season_id=season_id) }}">
            <input type="hidden" id="selectedMatchId" name="match_id">

            <div class="form-group">
                <label for="hostScore">Tỷ số Đội Nhà:</label>
                <input type="number" class="form-control" id="hostScore" name="host_score" required>
            </div>

            <div class="form-group">
                <label for="guestScore">Tỷ số Đội Khách:</label>
                <input type="number" class="form-control" id="guestScore" name="guest_score" required>
            </div>

            <h5>Nhập Kết Quả Bàn Thắng</h5>
            <table class="table table-bordered" id="resultTable">
                <thead>
                    <tr>
                        <th>Cầu Thủ</th>
                        <th>Loại Bàn Thắng</th>
                        <th>Thời Điểm</th>
                        <th>Hành Động</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Dynamic Rows Here -->
                </tbody>
            </table>
            <button type="button" class="btn btn-success" onclick="addResultRow()">Thêm Bàn Thắng</button>
            <button type="submit" class="btn btn-primary mt-3">Cập Nhật Kết Quả</button>
        </form>
    </div>
</div>
<script src="{{ url_for('static', filename='js/update_result.js') }}"></script>
{% endblock %}
